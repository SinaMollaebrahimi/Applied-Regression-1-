<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>e4484b8c97294d62b4a8b94922f7690e</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="505c70aa" class="cell markdown">
<h1
id="روش-اجرای-رگرسیون-خطی-در-r-"><div dir = 'rtl' style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">روش
اجرای رگرسیون خطی در <code>R</code> </div></h1>
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">

اجراي رگرسيون خطي ساده در اين نرم افزار را مي‌توان در دو گام اساسي به ترتيب زير بيان كرد:

گام اول: تعريف متغيرهاي مستقل و وابسته، ورود اطلاعات داده‌‌های مسئله یا فراخواندن داده ها در <code>R</code>

اولین و ساده‌ترین نوع ساختار داده در <code>R</code> ایجاد یک بردار عددی با استفاده از دستور <code>( )c</code> با فرم کلی 

<code>c(data, …)</code>

است، که در آن شناسه <code>data</code> عناصر بردار هستند. این بردار عددی مجموعه‌ای مرتب از مقادیر عددی، کاراکتری، و یا منطقی است. 

/با استفاده از این تابع در <code>R</code> می‌توان مقادیر دلخواه را با هم ترکیب نمود و یک بردار جدید ساخت. 

همچنین برای تخصیص یک بردار به یک شی می‌توان از عملگرهای تخصیص به شکل‌های <code>"<-"، "->"، "<<-"، "->>"</code>، و<code>"="</code> یا از تابع 

<code>( ) assign</code> به فرم کلی 

<code>assign(x,value)</code>

که در آن <code>x</code> نام متغیر مورد نظر و  <code>value</code> مقادیری که به آن اختصاص داده می‌شود، استفاده کرد.

مثال- هر سه عبارت زیر معادل یکدیگر هستند.


</div>
</div>
<div id="99d619a9" class="cell code" data-execution_count="2"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<div class="output display_data">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>-5</li><li>0</li><li>2</li><li>5</li><li>7</li><li>9</li></ol>

</div>
</div>
<div id="a0c74658" class="cell code" data-execution_count="3"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>) <span class="ot">-&gt;</span> x</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<div class="output display_data">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>-5</li><li>0</li><li>2</li><li>5</li><li>7</li><li>9</li></ol>

</div>
</div>
<div id="672c01d3" class="cell code" data-execution_count="4"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">assign</span>(<span class="st">&quot;x&quot;</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<div class="output display_data">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>-5</li><li>0</li><li>2</li><li>5</li><li>7</li><li>9</li></ol>

</div>
</div>
<div id="c728bf46" class="cell markdown">
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">حال می‌خواهیم برای اجرای مثال 2 در <code>R</code>، ابتدا  متغیرهای مستقل و وابسته را به‌صورت بردار در نرم افزارR  تعریف کنیم:</div>
</div>
<div id="6a0ec8e4" class="cell code" data-execution_count="5"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pieces <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">10</span>) <span class="co">#independent variable</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>pieces</span></code></pre></div>
<div class="output display_data">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>1</li><li>2</li><li>3</li><li>4</li><li>4</li><li>5</li><li>6</li><li>6</li><li>7</li><li>8</li><li>9</li><li>9</li><li>10</li><li>10</li></ol>

</div>
</div>
<div id="6435c1c3" class="cell code" data-execution_count="6"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>minutes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">29</span>,<span class="dv">49</span>,<span class="dv">64</span>,<span class="dv">74</span>,<span class="dv">87</span>,<span class="dv">96</span>,<span class="dv">97</span>,<span class="dv">109</span>,<span class="dv">119</span>,<span class="dv">149</span>,<span class="dv">145</span>,<span class="dv">154</span>,<span class="dv">166</span>)<span class="co"># dependent varibale</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>minutes</span></code></pre></div>
<div class="output display_data">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>23</li><li>29</li><li>49</li><li>64</li><li>74</li><li>87</li><li>96</li><li>97</li><li>109</li><li>119</li><li>149</li><li>145</li><li>154</li><li>166</li></ol>

</div>
</div>
<div id="67382da9" class="cell markdown">
<div dir='rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">

اغلب اوقات در نرم افزار <code>R</code> باید داده‌ها را از منبعی خارج از محیط این نرم افزار فراخوانی کرد. در این زبان داده‌های متنی <code>(text)</code> را می‌توان از روی فایل خواند. اگر داده‌ها در یک فایل متنی ذخیره شده باشند برای این منظور از دستور <code>( ) read.table</code> می‌توان استفاده کرد. همچنین این دستور قابلیت فراخوانی فایل‌‌هایی که با پسوند <code>csv (comma delimited)</code> ذخیره شده باشند را نیز دارد. فرم کلی این دستور به‌صورت زیر است:

</div>
<blockquote>
<p>read.table(file=" ", header=FALSE, sep=" ", row.names,
col.names,…)</p>
</blockquote>
</div>
<div id="61347eb3" class="cell code" data-execution_count="7"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data1.csv&quot;</span>,<span class="at">header=</span>T, <span class="at">sep=</span><span class="st">&quot;,&quot;</span>,<span class="at">fileEncoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mydata) <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">&quot;ردیف&quot;</span>,<span class="st">&quot;قطعه&quot;</span>,<span class="st">&quot;دقیقه&quot;</span> )</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>mydata</span></code></pre></div>
<div class="output display_data">
<table class="dataframe">
<caption>A data.frame: 14 × 3</caption>
<thead>
	<tr><th scope=col>ردیف</th><th scope=col>قطعه</th><th scope=col>دقیقه</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><td> 1</td><td> 1</td><td> 23</td></tr>
	<tr><td> 2</td><td> 2</td><td> 29</td></tr>
	<tr><td> 3</td><td> 3</td><td> 49</td></tr>
	<tr><td> 4</td><td> 4</td><td> 64</td></tr>
	<tr><td> 5</td><td> 4</td><td> 74</td></tr>
	<tr><td> 6</td><td> 5</td><td> 87</td></tr>
	<tr><td> 7</td><td> 6</td><td> 96</td></tr>
	<tr><td> 8</td><td> 6</td><td> 97</td></tr>
	<tr><td> 9</td><td> 7</td><td>109</td></tr>
	<tr><td> 1</td><td> 8</td><td>119</td></tr>
	<tr><td>11</td><td> 9</td><td>149</td></tr>
	<tr><td>12</td><td> 9</td><td>145</td></tr>
	<tr><td>13</td><td>10</td><td>154</td></tr>
	<tr><td>14</td><td>10</td><td>166</td></tr>
</tbody>
</table>

</div>
</div>
<div id="e6d7abff" class="cell markdown">
<div dir ='rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">
توجه داشته باشيد كه در سيستم عامل ويندوز براي اين كار از نماد <code>"\"</code> استفاده مي‌شود، در حالي كه در اين دستور آدرس فايل با <code>"/"</code> مشخص مي‌شود. چنانچه بخواهيم از نماد <code>"\"</code> استفاده كنيم، بايد در نام فايل از نماد <code>"\\ "</code> استفاده كنيم.

مثلا :

 </div>
<blockquote>
<p>mydata &lt;- read.table("C:\test\data.txt",header=T, sep="")</p>
</blockquote>
</div>
<div id="966b823a" class="cell markdown">
<div dir='rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">

براي دسترسي به متغيرهاي وابسته و مستقل مثال موجود بايد به ترتيب از دستورهاي <code>mydata$minutes</code> و <code>mydata$pieces</code> استفاده نماييم.
 </div>
<blockquote>
<p>mydata$minutes</p>
</blockquote>
</div>
<div id="f3d0f1d6" class="cell code" data-execution_count="8"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span><span class="st">`</span><span class="at">دقیقه</span><span class="st">`</span></span></code></pre></div>
<div class="output display_data">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>23</li><li>29</li><li>49</li><li>64</li><li>74</li><li>87</li><li>96</li><li>97</li><li>109</li><li>119</li><li>149</li><li>145</li><li>154</li><li>166</li></ol>

</div>
</div>
<div id="7aed6618" class="cell code" data-execution_count="9"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span><span class="st">`</span><span class="at">قطعه</span><span class="st">`</span></span></code></pre></div>
<div class="output display_data">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>1</li><li>2</li><li>3</li><li>4</li><li>4</li><li>5</li><li>6</li><li>6</li><li>7</li><li>8</li><li>9</li><li>9</li><li>10</li><li>10</li></ol>

</div>
</div>
<div id="2d6a33d6" class="cell markdown">
<div dir='rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">

زبان <code>R</code> به تنهايي قادر به فراخواني مستقيم  بسياري از فايل داده‌ها كه از قبل در نرم افزار <code>Excel</code> با پسوندهاي <code>xls*.</code> و يا <code>xlsx*.</code> ذخيره شده است، نمي باشد. بدين منظور براي  فرا خواندن چنين داده‌هايي سه راه حل زير پيشنهاد مي‌شود:

1-	ساده‌ترين حالت آن است كه داده‌‌ها را در <code>Excel</code> با پسوند *.txt ذخيره كرده و سپس با دستور <code>(“   ”)read.csv</code> آن را فراخواند.

2-	 حالت ديگر آن است كه داده‌‌ها را با پسوند <code>*.txt</code> ذخيره كرده و سپس با دستور <code>(“   “)read.table</code> 
آن را فراخواند.

3-	همچنين مي‌توان با استفاده از دستور <code>( )read.xls</code> كه در بسته نرم افزاري <code>gdata</code> موجود است و يا با استفاده از دستور <code>()read.xlsx</code> در بسته نرم افزاري <code>xlsx</code> و دستور <code>( )read.xlsx2</code> در بسته نرم افزاري <code>xlsxjars</code> فايل‌هاي <code>Excel</code> را فراخواني كرد.
همچنين براي فراخواني فايل داد‌ه‌هايي كه در نرم افزار <code>spss</code> با پسوند <code>sav.</code> يا <code>savd.</code> ذخيره شده‌اند، در زبان <code>R</code> نمي‌توان به‌صورت مستقيم عمل كرد. با استفاده از دستور <code>( )read.spss</code> در بسته‌ي نرم افزاري ‌<code>foreign</code> و يا دستور <code>( )spss.get</code> در بسته نرم افزاري <code>Hmisc</code> مي‌توان فايل داده‌ها را از نرم افزار <code>spss</code> به <code>R</code> فراخواني كرد.


</div>
</div>
<div id="01201fb9" class="cell markdown">
<div dir='rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">

**گام دوم: اجراي مدل رگرسيون خطي ساده**

براي  اجراي تحليل رگرسيون خطي ساده در <code>R</code> ابتدا بايد نمودار پراكنش داده‌ها <code>(Scatter Plot)</code> براي مطالعه رابطه بين دو
متغير را به  وسيله  دستور <code>( )plot</code>  رسم مي‌كنيم.
</div>
</div>
<div id="4974f8bc" class="cell code" data-execution_count="10"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pieces, minutes)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_1e9e441295de4aa9bdbe03e6c05dfa8f/ba690a4864d22da611588965eb4a5ffe8d0ec47c.png"
width="420" height="420" /></p>
</div>
</div>
<div id="a97f8df2" class="cell markdown">
<div dir ='rtl' style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;" >
<p>نمودار پراكنش يك روند خطي با شيب مثبت را نشان مي‌دهد. سپس مي‌توان ضريب
همبستگي و آزمون مربوط به آن را با استفاده از كد زير بررسي نمود.</p>
</div>
<div id="295d39e0" class="cell code" data-execution_count="11"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(mydata<span class="sc">$</span><span class="st">`</span><span class="at">قطعه</span><span class="st">`</span>, mydata<span class="sc">$</span><span class="st">`</span><span class="at">دقیقه</span><span class="st">`</span>)</span></code></pre></div>
<div class="output display_data">
<pre><code>
	Pearson&#39;s product-moment correlation

data:  mydata$قطعه and mydata$دقیقه
t = 30.712, df = 12, p-value = 8.916e-13
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.9795996 0.9980632
sample estimates:
      cor 
0.9936987 
</code></pre>
</div>
</div>
<div id="3221d92f" class="cell markdown">
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">
حال بايد تابع مدل را تعيين و در زبان <code>R</code> معرفي كنيم. براي معرفي مدل رگرسيون خطي ساده به طور معمول از تابع <code>( )lm</code> كه مخفف <code>linear model</code> است، استفاده مي‌كنيم. فرم كلي اين تابع به‌صورت زير است:
<code>lm(formula, data, weights, subset, na.action)</code>
كه در آن شناسه <code>formula</code> فرمول مدلي است كه مي‌خواهيم به داده‌ها برازش دهيم. براي تعريف يك مدل خطي در تابع </code>lm( )</code> از علامت “~” بين نام متغير وابسته و متغيرهاي مستقل استفاده مي‌كنيم.
 به طور پيش فرض زبان <code>R</code> شامل عرض از مبدا مي‌باشد. از<code>"1-"</code>زماني استفاده مي‌كنيم كه مدل داراي عرض از مبدا نباشد. به عنوان مثال يك مدل رگرسيون خطي ساده با دو متغير وابسته<code>y</code>  و متغير مستقل <code>x</code>  و عرض از مبدا صفر به‌صورت زيرتوسط تابع <code>( )lm</code> تعريف مي‌شود:

<code>y~-1+x</code>

 به‌صورت زير اجرا مي‌شود:


</div>
</div>
<div id="d26b5483" class="cell code" data-execution_count="12"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>linreg <span class="ot">&lt;-</span> <span class="fu">lm</span>(minutes<span class="sc">~</span>pieces, <span class="at">data=</span>mydata)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>linreg</span></code></pre></div>
<div class="output display_data">
<pre><code>
Call:
lm(formula = minutes ~ pieces, data = mydata)

Coefficients:
(Intercept)       pieces  
      4.162       15.509  
</code></pre>
</div>
</div>
<div id="9b0707a5" class="cell markdown">
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">
نتيجه اين تابع را در متغيري به نام <code>linreg</code> ثبت كرده‌ايم.
كد بالا را مي‌توان به شكل زير نيز نوشت. 
</div>
</div>
<div id="47a504d6" class="cell code" data-execution_count="13"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb14"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>linreg <span class="ot">&lt;-</span> <span class="fu">lm</span>(mydata<span class="sc">$</span><span class="st">`</span><span class="at">دقیقه</span><span class="st">`</span><span class="sc">~</span>mydata<span class="sc">$</span><span class="st">`</span><span class="at">قطعه</span><span class="st">`</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>linreg</span></code></pre></div>
<div class="output display_data">
<pre><code>
Call:
lm(formula = mydata$دقیقه ~ mydata$قطعه)

Coefficients:
(Intercept)  mydata$قطعه  
      4.162       15.509  
</code></pre>
</div>
</div>
<div id="0fb7297f" class="cell markdown">
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">

براي مشاهده اطلاعات اضافي از مدل برازش يافته نظير ضرايب رگرسيوني، معيار <code><b>R<sup>2</sup></b></code>، مقدار <code>p-value</code> مربوط به آزمون معني‌داري مدل، خطاي استاندار ، همبستگي بين پارامترها و ... از تابع <code>( ) summary</code> استفاده مي‌كنيم.
</div>
</div>
<div id="2b700740" class="cell code" data-execution_count="14"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb16"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">summary</span>(linreg)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>result</span></code></pre></div>
<div class="output display_data">
<pre><code>
Call:
lm(formula = mydata$دقیقه ~ mydata$قطعه)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.2318 -3.3415 -0.7143  4.7769  7.8033 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    4.162      3.355    1.24    0.239    
mydata$قطعه   15.509      0.505   30.71 8.92e-13 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 5.392 on 12 degrees of freedom
Multiple R-squared:  0.9874,	Adjusted R-squared:  0.9864 
F-statistic: 943.2 on 1 and 12 DF,  p-value: 8.916e-13
</code></pre>
</div>
</div>
<div id="97fa2a52" class="cell markdown">
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">

مقدار <code>p-value</code> مربوط به شيب خط نشان دهنده‌ي معني دار بودن آن است.
اسامي مقاديري كه در متغير <code>linreg</code>  ذخيره شده است را مي‌توان به وسيله‌ي كد زير مشاهده كرد:

</div>
</div>
<div id="1dafc7ec" class="cell code" data-execution_count="15"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb18"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(linreg)</span></code></pre></div>
<div class="output display_data">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'coefficients'</li><li>'residuals'</li><li>'effects'</li><li>'rank'</li><li>'fitted.values'</li><li>'assign'</li><li>'qr'</li><li>'df.residual'</li><li>'xlevels'</li><li>'call'</li><li>'terms'</li><li>'model'</li></ol>

</div>
</div>
<div id="8cba7f39" class="cell markdown">
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">
حال مي‌توان خط رگرسيوني پس از نمودار پراكنش را با استفاده از دستور <code>( )abline</code> به شكل زير كشيد:
</div>
</div>
<div id="f0f59510" class="cell code" data-execution_count="16"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb19"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pieces, minutes)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(linreg)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_1e9e441295de4aa9bdbe03e6c05dfa8f/bb4231411ab2896b526f0cd1b391aac5d55e1d72.png"
width="420" height="420" /></p>
</div>
</div>
<div id="4225b957" class="cell markdown">
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">
همچنين از دستور زير نيز مي‌توان براي رسم خط برازش داده شده به داده مورد نظر استفاده نمود:
</div>
</div>
<div id="e687cf4d" class="cell code" data-execution_count="17"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb20"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pieces, minutes)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(mydata<span class="sc">$</span><span class="st">`</span><span class="at">قطعه</span><span class="st">`</span>, <span class="fu">fitted</span>(linreg))</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_1e9e441295de4aa9bdbe03e6c05dfa8f/028d39dfa3e5de686bd9c894e99c7129cb7689b1.png"
width="420" height="420" /></p>
</div>
</div>
<div id="8299b1db" class="cell markdown">
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">
حال اگر بخواهيم علاوه بر نقاط داده‌ها و خط برازش داده شده به آنها، باقيمانده‌‌‌ها را نيز به نمودار اضافه کنیم به شكل زير عمل مي‌كنيم:
</div>
</div>
<div id="9e907585" class="cell code" data-execution_count="18"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb21"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pieces, minutes)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(mydata<span class="sc">$</span><span class="st">`</span><span class="at">قطعه</span><span class="st">`</span>, <span class="fu">fitted</span>(linreg))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(mydata<span class="sc">$</span><span class="st">`</span><span class="at">قطعه</span><span class="st">`</span>, <span class="fu">fitted</span>(linreg), mydata<span class="sc">$</span><span class="st">`</span><span class="at">قطعه</span><span class="st">`</span>, mydata<span class="sc">$</span><span class="st">`</span><span class="at">دقیقه</span><span class="st">`</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_1e9e441295de4aa9bdbe03e6c05dfa8f/3e6c0b4753d27a7c44469422e348e8410e8e20b8.png"
width="420" height="420" /></p>
</div>
</div>
<div id="f0bc5e43" class="cell markdown">
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">
براي مشاهده مقادير پيش بيني شده مي‌توان از هر يك سه دستور زير استفاده نمود.
</div>
</div>
<div id="c862d121" class="cell code" data-execution_count="19"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb22"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pred<span class="ot">=</span><span class="fu">predict</span>(linreg)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>pred<span class="ot">=</span><span class="fu">fitted</span>(linreg)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>pred<span class="ot">=</span>linreg<span class="sc">$</span>fitted</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>pred</span></code></pre></div>
<div class="output display_data">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>1</dt><dd>19.6704260651629</dd><dt>2</dt><dd>35.1791979949875</dd><dt>3</dt><dd>50.687969924812</dd><dt>4</dt><dd>66.1967418546366</dd><dt>5</dt><dd>66.1967418546366</dd><dt>6</dt><dd>81.7055137844612</dd><dt>7</dt><dd>97.2142857142857</dd><dt>8</dt><dd>97.2142857142857</dd><dt>9</dt><dd>112.72305764411</dd><dt>10</dt><dd>128.231829573935</dd><dt>11</dt><dd>143.740601503759</dd><dt>12</dt><dd>143.740601503759</dd><dt>13</dt><dd>159.249373433584</dd><dt>14</dt><dd>159.249373433584</dd></dl>

</div>
</div>
<div id="a8e64a47" class="cell markdown">
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">
برای مشاهده مقادیر باقیمانده‌ها می‌توان هر یک از دستورات زیر را به کار برد.
</div>
</div>
<div id="a5f67fe6" class="cell code" data-execution_count="20"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb23"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> minutes<span class="sc">-</span>pred</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">residuals</span>(linreg)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> linreg<span class="sc">$</span>residuals </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>res</span></code></pre></div>
<div class="output display_data">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>1</dt><dd>3.32957393483713</dd><dt>2</dt><dd>-6.1791979949875</dd><dt>3</dt><dd>-1.68796992481203</dd><dt>4</dt><dd>-2.1967418546366</dd><dt>5</dt><dd>7.80325814536341</dd><dt>6</dt><dd>5.29448621553884</dd><dt>7</dt><dd>-1.21428571428572</dd><dt>8</dt><dd>-0.214285714285716</dd><dt>9</dt><dd>-3.72305764411028</dd><dt>10</dt><dd>-9.23182957393484</dd><dt>11</dt><dd>5.25939849624061</dd><dt>12</dt><dd>1.2593984962406</dd><dt>13</dt><dd>-5.24937343358395</dd><dt>14</dt><dd>6.75062656641605</dd></dl>

</div>
</div>
<div id="82ccbf1c" class="cell markdown">
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">
حال می‌توان مقادير پيش بيني شده را در مقابل مقادیر باقیمانده‌ها به وسیله کد زیر ترسیم کرد.
</div>
</div>
<div id="ef38fbe4" class="cell code" data-execution_count="21"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb24"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pred,res)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_1e9e441295de4aa9bdbe03e6c05dfa8f/787299ac3fca176a36a52a838f888e4cde13466d.png"
width="420" height="420" /></p>
</div>
</div>
<div id="c5a9404a" class="cell markdown">
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">
<p>همانطور که در شکل مشاهده می‌شود باقیمانده‌ها به طور تصادفی در اطراف صفر
پراکنده هستند و از روند خاصی پیروی نمی‌کنند، بنابراین این امر برای مناسب
بودن مدل مطلوب می‌باشد. همچنین فرض نرمال بودن باقیمانده‌ها را می‌توان توسط
نمودار <code>Q-Q plot</code> بررسی کرد.</p>
</div>
<div id="5455892e" class="cell code" data-execution_count="22"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb25"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(res)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(res)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_1e9e441295de4aa9bdbe03e6c05dfa8f/722e7a092d16c5e571f331f72e33f10e7f428a3d.png"
width="420" height="420" /></p>
</div>
</div>
<div id="5743bfd4" class="cell markdown">
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">
<p>برای مشاهده فواصل اطمینان مربوط به پارامترهای مدل اعم از عرض از مبدا
و شیب خط رگرسیونی از تابع <code>( )confing</code> استفاده می‌کنیم.</p>
</div>
<div id="233ddfea" class="cell code" data-execution_count="23"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb26"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(<span class="fu">lm</span>(minutes<span class="sc">~</span>pieces),<span class="at">level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<div class="output display_data">
<table class="dataframe">
<caption>A matrix: 2 × 2 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>
</thead>
<tbody>
	<tr><th scope=row>(Intercept)</th><td>-3.148482</td><td>11.47179</td></tr>
	<tr><th scope=row>pieces</th><td>14.408512</td><td>16.60903</td></tr>
</tbody>
</table>

</div>
</div>
<div id="afb8766a" class="cell markdown">
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">
تشخیص مدل 

برای بررسی برقرار بودن فرض‌های مدل خطی به عنوان مثال 

i.	آیا باقیمانده‌ها نرمال هستند؟

ii.	آیا مقادیر پرت وجود دارد؟

iii.	آیا رابطه بین متغیر پاسخ و متغیر‌های رگرسیون خطی هستند؟

می‌توان از آزمون‌‌ها و شاخص‌های زیر استفاده نمود. آزمون کلموگروف-اسمیرونوف را می‌توان برای بررسی نرمال بودن باقیمانده‌ها به کار برد.
</div>
</div>
<div id="e165917d" class="cell code" data-execution_count="24"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb27"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">resid</span>(linreg)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>res</span></code></pre></div>
<div class="output display_data">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>1</dt><dd>3.32957393483713</dd><dt>2</dt><dd>-6.1791979949875</dd><dt>3</dt><dd>-1.68796992481203</dd><dt>4</dt><dd>-2.1967418546366</dd><dt>5</dt><dd>7.80325814536341</dd><dt>6</dt><dd>5.29448621553884</dd><dt>7</dt><dd>-1.21428571428572</dd><dt>8</dt><dd>-0.214285714285716</dd><dt>9</dt><dd>-3.72305764411028</dd><dt>10</dt><dd>-9.23182957393484</dd><dt>11</dt><dd>5.25939849624061</dd><dt>12</dt><dd>1.2593984962406</dd><dt>13</dt><dd>-5.24937343358395</dd><dt>14</dt><dd>6.75062656641605</dd></dl>

</div>
</div>
<div id="c2763c44" class="cell code" data-execution_count="25"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb28"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(res,<span class="st">&quot;pnorm&quot;</span>, <span class="at">mean=</span><span class="fu">mean</span>(res),<span class="at">sd=</span><span class="fu">sd</span>(res))</span></code></pre></div>
<div class="output display_data">
<pre><code>
	Exact one-sample Kolmogorov-Smirnov test

data:  res
D = 0.13073, p-value = 0.9452
alternative hypothesis: two-sided
</code></pre>
</div>
</div>
<div id="44602751" class="cell markdown">
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">با استفاده از دستورات زیر در دنباله کدهای قبلی که کاربرد تابع <code>( )plot</code> به همراه تابع  <code>( )lm</code>   می‌باشد، می‌توان صحت مدل را بررسی کرد. به وسیله تابع <code>( )plot</code> چهار نمودار رسم می‌شود که یکی پس از دیگری نمایش داده می‌شوند. برای نمایش هر چهار نمودار در یک صفحه از دستور <code>( )par</code> به‌صورت <code>(mfrow=c(2, 2))par</code> پیش از تابع    <code>( )plot</code>استفاده می‌کنیم.
</div>
</div>
<div id="2b44629c" class="cell code" data-execution_count="26"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb30"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">lm</span>(minutes<span class="sc">~</span>pieces))</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_1e9e441295de4aa9bdbe03e6c05dfa8f/b940151f0b462c30f41acfe07ee2d9ba23baff19.png"
width="420" height="420" /></p>
</div>
</div>
<div id="f1fdd4de" class="cell markdown">
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">
<p>این چهارشکل عبارت‌اند از:</p>
<p>i. مقادیر برازش یافته در مقابل مقادیر باقیمانده‌ها: نمودار حاصل باید
حول خط <code>y=0</code> قرار گیرد و روند خاصی را از خود نشان ندهد.</p>
<p>ii. نمودار <code>Q-Q plot</code> : اگر نقاط باقیمانده‌ها نزدیک به
نمایش خط مستقیم باشند، می‌توان گفت که نمودار باقیمانده‌‌ها از توزیع نرمال
پیروی می‌کند.</p>
<p>iii. نمودار مقیاس- مکان <code>Scale-location</code> : در این نمودار
ریشه دوم باقیمانده‌های استاندارد شده نشان داده‌ می‌شود. نقاط بلند بزرگترین
مقادیر باقیمانده هستند.</p>
<p>نمودار <code>Cook’s distance</code>: در این نمودار نقاطی که روی خط
رگرسیون تاثیر فراوانی می‌گذارند که می‌توان به عنوان نقاط پرت تلقی شوند
نشان داده می‌شود.</p>
</div>
<div id="37a0b0dc" class="cell markdown">
<div dir="rtl"style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">
<h3 id="رگرسیون-خطی-چندگانه">رگرسیون خطی چندگانه</h3>
<p>رگرسیون خطی چندگانه با فرم کلی زیر تعریف می‌شود: <div dir='ltr'></p>
<p><span
class="math display"><em>Y</em><sub><em>i</em></sub> = <em>β</em><sub>0</sub> + <em>β</em><sub>1</sub><em>X</em><sub>1<em>i</em></sub> + <em>β</em><sub>2</sub><em>X</em><sub>2<em>i</em></sub> + ⋯ + <em>β</em><sub><em>p</em> − 1</sub><em>X</em><sub>(<em>p</em>−1)<em>i</em></sub> + <em>ε</em><sub><em>i</em></sub></span></p>
</div>
<p>که در آن<br />
<div dir='ltr'></p>
<p><span
class="math display"><em>β</em><sub>0</sub>, <em>β</em><sub>1</sub>, …, <em>β</em><sub><em>p</em> − 1</sub></span>
</div></p>
<div dir="rtl" style="font-size:16px; line-height:1.9; text-align:justify">
<p>پارامترهای مدل یا ضرایب <strong>رگرسیونی</strong> هستند.</p>
<p>فرمول کلی متغیرهای مستقل به‌صورت زیر است: <div dir = 'ltr'></p>
<p><span
class="math display"><em>X</em><sub>1<em>i</em></sub>, …, <em>X</em><sub>(<em>p</em>−1)<em>i</em></sub></span></p>
</div>
<p>که متغیرهای مستقل با مقادیر معلوم‌اند.</p>
<p>همچنین جملات خطا به‌شکل زیر فرض می‌شوند: <div dir='ltr'></p>
<p><span
class="math display"><em>ε</em><sub><em>i</em></sub> ∼ <em>N</em>(0,<em>σ</em><sup>2</sup>)</span></p>
</div>
<p>تحلیل <strong>رگرسیون خطی چندگانه</strong> در <code>R</code> با
استفاده از تابع <code>()lm</code> انجام می‌شود.<br />
برای معرفی مدل رگرسیون خطی چندگانه کافی است متغیرهای مستقل را با علامت
<code>+</code> در کنار تابع <code>()lm</code> وارد کنیم.<br />
بقیه‌ی مراحل مشابه تحلیل رگرسیون خطی ساده است.</p>
<h4 id="مثال">مثال</h4>
<p>در حالت رگرسیون خطی با دو متغیر مستقل، می‌توان از کد زیر استفاده
نمود:</p>
</div>
<div id="b7596e44" class="cell code" data-execution_count="27"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb31"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>my_data_2 <span class="ot">=</span> <span class="fu">read.table</span>(<span class="st">&#39;data2.csv&#39;</span>,<span class="at">sep=</span><span class="st">&#39;,&#39;</span>,<span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(my_data_2) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;Y&#39;</span>,<span class="st">&#39;X_1&#39;</span>,<span class="st">&#39;X_2&#39;</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>my_data_2</span></code></pre></div>
<div class="output display_data">
<table class="dataframe">
<caption>A data.frame: 15 × 3</caption>
<thead>
	<tr><th scope=col>Y</th><th scope=col>X_1</th><th scope=col>X_2</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><td>162</td><td>274</td><td>2450</td></tr>
	<tr><td>120</td><td>180</td><td>3254</td></tr>
	<tr><td>223</td><td>375</td><td>3802</td></tr>
	<tr><td>131</td><td>205</td><td>2838</td></tr>
	<tr><td> 67</td><td> 86</td><td>2347</td></tr>
	<tr><td>169</td><td>265</td><td>3782</td></tr>
	<tr><td> 81</td><td> 98</td><td>3008</td></tr>
	<tr><td>192</td><td>330</td><td>2450</td></tr>
	<tr><td>116</td><td>195</td><td>2137</td></tr>
	<tr><td> 55</td><td> 53</td><td>2560</td></tr>
	<tr><td>252</td><td>430</td><td>4020</td></tr>
	<tr><td>232</td><td>372</td><td>4427</td></tr>
	<tr><td>144</td><td>236</td><td>2660</td></tr>
	<tr><td>103</td><td>157</td><td>2088</td></tr>
	<tr><td>212</td><td>370</td><td>2605</td></tr>
</tbody>
</table>

</div>
</div>
<div id="bad93bee" class="cell markdown">
<div dir='rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">

پیش از استفاده از مدل رگرسیون می خواهیم بررسی کنیم که متغیرها چگونه با یکدیگر در ارتباط هستند. بدین منظور می توانیم با ساختن نمودار پراکنش زوجی همه ترکیبات جفتی متغیرها را در یک نمودار ترسیم نماییم. این  نمودار توسط کد زیر بدست خواهد آمد:

</div>
</div>
<div id="162823b3" class="cell code" data-execution_count="28"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb32"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(my_data_2)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_1e9e441295de4aa9bdbe03e6c05dfa8f/0ad0e833d6fb9fad35328cd11e512c5a22503f22.png"
width="420" height="420" /></p>
</div>
</div>
<div id="11d5b625" class="cell markdown">
<div dir='rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">

برای اجرای  یک مدل رگرسیون خطی چندگانه با ميزان فروش هر ناحيه 
<div dir='ltr'>

$$( y_{i} )$$

</div>
به عنوان متغير وابسته و جمعيت 

<div dir='ltr'>

$$( X_{1i} )$$

</div>
 و درامد سرانه
<div dir='ltr'>


$$( X_{2i} )$$

</div>
  
به عنوان متغیرهای مستقل، از دستور استفاده کنید:

</div>
</div>
<div id="e0debae8" class="cell code" data-execution_count="29"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb33"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">=</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X_1 <span class="sc">+</span> X_2, <span class="at">data=</span>my_data_2)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>results</span></code></pre></div>
<div class="output display_data">
<pre><code>
Call:
lm(formula = Y ~ X_1 + X_2, data = my_data_2)

Coefficients:
(Intercept)          X_1          X_2  
   3.452613     0.496005     0.009199  
</code></pre>
</div>
</div>
<div id="134bb59a" class="cell markdown">
<div dir ='rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">
این خروجی نشان می‌دهد که معادله رگرسیون خطی چندگانه برازش داده شده برابراست با
</div>
<div dir ='ltr'>

$$

\hat{y}=3/452613  +0/496005  x_1+0/009199x_2

$$


</div>
</div>
<div id="d2bcf92e" class="cell markdown">
<div dir='rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">
برای انجام استنباط در مورد ضرایب رگرسیونی مدل رگرسیون خطی چندگانه به شکل زیر عمل می‌کنیم:

</div>
</div>
<div id="d019a6db" class="cell code" data-execution_count="31"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb35"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results)</span></code></pre></div>
<div class="output display_data">
<pre><code>
Call:
lm(formula = Y ~ X_1 + X_2, data = my_data_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.8320 -1.2044 -0.2406  1.4888  3.3092 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 3.4526128  2.4306505   1.420    0.181    
X_1         0.4960050  0.0060544  81.924  &lt; 2e-16 ***
X_2         0.0091991  0.0009681   9.502  6.2e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 2.177 on 12 degrees of freedom
Multiple R-squared:  0.9989,	Adjusted R-squared:  0.9988 
F-statistic:  5679 on 2 and 12 DF,  p-value: &lt; 2.2e-16
</code></pre>
</div>
</div>
<div id="fdce1bf6" class="cell markdown">
<div dir = 'rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">

خروجی نشان می‌دهد که  مقدار آماره آزمون برابر است با F=5679(P-value=2.2e-16). که نشانگر آن است که فرض صفر در سطح معنی دار 0/05 رد می‌شود. این بدان معناست که حداقل یکی از متغیرهای مستقل جمعيت (   X_1    ) یا درامد سرانه ( X_2  ) تاثیر بر ميزان فروش هر ناحيه $\left(Y\right)$ دارند.
</div>
</div>
<div id="7f07c80c" class="cell markdown">
<div dir='rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">

# به دست آوردن فواصل اطمینان و پیش‌بینی

اگر بخواهیم یک فاصله اطمینان 95٪ برای متوسط میزان فروش هر ناحیه که درآن جمعیت 100 و درآمد سرانه  2000 باشد، به‌دست آوریم از دستور زیر استفاده می‌کنیم:


</div >
</div>
<div id="8706027f" class="cell code" data-execution_count="34"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb37"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(results,<span class="fu">data.frame</span>(<span class="at">X_1=</span><span class="dv">100</span>, <span class="at">X_2=</span><span class="dv">2000</span>),<span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<table class="dataframe">
<caption>A matrix: 1 × 3 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>fit</th><th scope=col>lwr</th><th scope=col>upr</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>71.45127</td><td>69.26065</td><td>73.64189</td></tr>
</tbody>
</table>

</div>
</div>
<div id="51d0bb1d" class="cell markdown">
<div dir='rtl'style="font-family: 'B Nazanin', 'IRANSans', 'Tahoma'; font-size: 16px; line-height: 1.8; text-align: justify;">

# تست کردن یک زیرمجموعه از متغیرها با استفاده از یک آزمون F-جزئی

در R می توانیم با استفاده از هر دو مدل کاهش یافته و کامل، آزمون F را به طور جداگانه انجام دهیم.  پس از آن آ‌ن‌ها را با استفاده از تابع anova مقایسه کنیم. 

</div>
</div>
<div id="1c8fb992" class="cell code" data-execution_count="35"
data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode" id="cb38"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>reduced <span class="ot">=</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X_1, <span class="at">data=</span>my_data_2) <span class="co"># Reduced model</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>full <span class="ot">=</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X_1 <span class="sc">+</span> X_2, <span class="at">data=</span>my_data_2) <span class="co"># Full Model</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(reduced, full) <span class="co"># Compare the models</span></span></code></pre></div>
<div class="output display_data">
<table class="dataframe">
<caption>A anova: 2 × 6</caption>
<thead>
	<tr><th></th><th scope=col>Res.Df</th><th scope=col>RSS</th><th scope=col>Df</th><th scope=col>Sum of Sq</th><th scope=col>F</th><th scope=col>Pr(&gt;F)</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>13</td><td>484.88137</td><td>NA</td><td>      NA</td><td>      NA</td><td>          NA</td></tr>
	<tr><th scope=row>2</th><td>12</td><td> 56.88357</td><td> 1</td><td>427.9978</td><td>90.28923</td><td>6.201181e-07</td></tr>
</tbody>
</table>

</div>
</div>
</body>
</html>
